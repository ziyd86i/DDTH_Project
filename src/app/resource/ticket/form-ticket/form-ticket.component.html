<header-cm></header-cm>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      <h1>{{title}}</h1>
      <hr>
    </div>
  </div>

   <form (ngSubmit)="managedTicket()" [formGroup]="form">
     <div  class="form-group">
       <div class="row">
         <div class="col-md-2 col-md-offset-3">
           <label>Ticket / SVR / Project : <b style="color:red;">*</b></label>
         </div>
         <div class="col-md-3" [ngClass]="{'has-error':!form.controls['ticket_name'].valid && form.controls['ticket_name'].touched}">
           <p><input
              type="text"
              class="form-control"
              id="ticket_id"
              [(ngModel)]="tickets.ticket_name"
              formControlName="ticket_name"
              maxlength="40"
              >
            </p>
            <span class="help-block" *ngIf="!form.controls['ticket_name'].valid
                                          && form.controls['ticket_name'].touched">Please input Ticket</span>

         </div>


       </div>

       <div class="row">
         <div class="col-md-2 col-md-offset-3">
           <label>SO Number: </label>
         </div>
         <div class="col-md-3">
           <input
                 type="text"
                 class="form-control"
                 id="so_number"
                 [(ngModel)]="tickets.so_number"
                 formControlName="so_number"
                 >
         </div>
       </div>

       <div class="row">
         <div class="col-md-2 col-md-offset-3">
           <label>Case Owner / Engineer: </label>
         </div>
         <div class="col-md-3">
           <input
                 type="text"
                 class="form-control"
                 id="owner"
                 [(ngModel)]="tickets.owner"
                 formControlName="owner"
                 >
         </div>
       </div>

       <div class="row">
         <div class="col-md-2 col-md-offset-3">
           <label>Customer:<b style="color:red;">*</b></label>
         </div>
         <div class="col-md-3" [ngClass]="{'has-error':!form.controls['customer_name'].valid && form.controls['customer_name'].touched}">
           <input
                 type="text"
                 class="form-control"
                 id="customer_name"
                 [(ngModel)]="tickets.customer_name"
                 formControlName="customer_name"
                 >
                 <span class="help-block" *ngIf="!form.controls['customer_name'].valid
                                                     && form.controls['customer_name'].touched">Please input Customer Name</span>
         </div>
       </div>

       <div class="row">
         <div class="col-md-2 col-md-offset-3">
           <label>Personal Contact:</label>
         </div>
         <div class="col-md-3">
           <input
                 type="text"
                 class="form-control"
                 id="person_contact"
                 [(ngModel)]="tickets.person_contact"
                 formControlName="person_contact"
                 >
         </div>
       </div>

       <!-- <div class="row">
         <div class="col-md-3">
           <label>Time start :</label>
         </div>
         <div class="col-md-3">
           <datetime
                  [datepicker]="false"
                  [(ngModel)]="tickets.time"
                  formControlName="time">
           </datetime>
         </div>
       </div> -->
       <div class="row">
         <div class="col-md-2 col-md-offset-3">
           <label>Contract Number: </label>
         </div>
         <div class="col-md-3">
           <input
                 type="text"
                 class="form-control"
                 id="tel"
                 maxlength="10"
                 [(ngModel)]="tickets.tel"
                 formControlName="tel"
                 >
                 <span class="help-block" *ngIf="!form.controls['tel'].valid
                                                     && form.controls['tel'].touched">Please Input valid number</span>
         </div>
       </div>

       <div class="row">
         <div class="col-md-2 col-md-offset-3">
           <label>Start Date: <b style="color:red;">*</b></label>
         </div>
         <div class="col-md-3" [ngClass]="{'has-error':!form.controls['date'].valid && form.controls['date'].touched }">

                <dx-date-box
                class="form-control"
                formControlName="date"
                [(value)]="tickets.date"
                type="datetime"
                dateSerializationFormat="yyyy-MM-ddTHH:mm:ss"
                (onValueChanged)="changeEndDate($event)"
                >
                </dx-date-box>
                <!-- (onValueChanged)="changeEndDate(tickets.date)" -->
                <span class="help-block" *ngIf="!form.controls['date'].valid
                                                    && form.controls['date'].touched">Please Input Start Date</span>
                <!-- <input
                type="text"
                [(ngModel)]="tickets.date"
                class="form-control"
                ngui-datetime-picker
                formControlName="date"
                date-format = "YYYY/MM/DD, HH:mm"
                [close-on-select]="false"
                required
                 /> -->
         </div>
       </div>

       <div class="row">
         <div class="col-md-2 col-md-offset-3">
           <label>End Date: <b style="color:red;">*</b></label>
         </div>
         <div class="col-md-3" [ngClass]="{'has-error':!form.controls['end_date'].valid && form.controls['end_date'].touched}">

           <dx-date-box
           class="form-control"
           formControlName="end_date"
           [(value)]="tickets.end_date"
           type="datetime"
           dateSerializationFormat="yyyy-MM-ddTHH:mm:ss"
           >

           </dx-date-box>
           <span class="help-block" *ngIf="!form.controls['end_date'].valid
                                         && form.controls['end_date'].touched">Please Input end date</span>
                <!-- <input
                type="text"
                [(ngModel)]="tickets.end_date"
                class="form-control"
                ngui-datetime-picker
                formControlName="end_date"
                date-format = "YYYY/MM/DD, HH:mm"
                [close-on-select]="false"
                required
                 /> -->
         </div>
       </div>

       <div class="row">
         <div class="col-md-2 col-md-offset-3">
           <label>Description:</label>
         </div>
         <div class="col-md-3">
           <textarea
                    class="form-control"
                    id="description"
                    [(ngModel)]="tickets.description"
                    formControlName="description"
                    rows="10" cols="50"></textarea>
         </div>
       </div>







     </div>
     <!-- <button type="submit" class="btn btn-success" >Add Ticket</button> -->
     <hr>
     <div class="text-center">
       <p *ngIf="!editted">
         <button type="submit" class="btn btn-success" [disabled]="!form.valid" style="margin-right:10px;">Add Ticket</button>
         <button type="submit" class="btn btn-default"  [routerLink]="['/cm/ticket']" > Back </button>

       </p>
       <p *ngIf="editted">
         <button type="submit" class="btn btn-warning" [disabled]="!form.valid" style="margin-right:10px;"> Ediit</button>
         <button type="submit" class="btn btn-default"  [routerLink]="['/cm/ticket']" >Back</button>
       </p>
     </div>


   </form>
</div>
